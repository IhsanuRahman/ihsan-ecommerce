{%extends 'base.html' %}
{%block 'title'%}verification{%endblock%}
{%block 'body'%}
    <section class="w-100 h-100 d-flex justify-content-center align-items-center">
        <form class="form-group col-10 col-md-6 col-lg-3 " style="margin-bottom: 100px;" method="post" enctype="multipart/form-data">
            {%csrf_token%}
            <label for="username" class="form-label w-100">enter otp</label>
            {{form.otp}}
            {{form.otp.errors}}
            <br>
            <a id="reset" class="btn  mt-2">resend <span id="timer"></span></a> 
            
        <button type="submit"  class="mt-3 btn btn-dark d-flex ms-auto">verify</button>
        </form>
    </section>
{%endblock%}
{%block 'script'%}
<script type="text/javascript">
let timerOn = true;

function timer(remaining) {
  var m = Math.floor(remaining / 60);
  var s = remaining % 60;
  
  m = m < 10 ? '0' + m : m;
  s = s < 10 ? '0' + s : s;
  document.getElementById('timer').innerHTML = '('+m + ':' + s+')';
  remaining -= 1;
  
  if(remaining >= 0 && timerOn) {
    setTimeout(function() {
        timer(remaining);
    }, 1000);
    return;
  }else{
   
  }

  if(!timerOn) {
    // Do validate stuff here
    
    return;
  }
  document.getElementById('timer').innerHTML=''
  document.getElementById('reset').href="/user/reset-otp"
  document.getElementById('reset').classList.add('btn-success')
  // Do timeout stuff here
}

timer(Number('{{timeout}}')); 
</script>
{%endblock%}