{%extends 'base.html' %}
{%block 'title' %}
Wishlist
{%endblock%}
{%block 'head'%}
{%load static%}


<link rel="stylesheet" href="https://unpkg.com/@trevoreyre/autocomplete-js/dist/style.css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" />

<style>

</style>
{%endblock%}
{%block 'body'%}

{%include 'user/header.html'%}
<div class="d-flex justify-content-between m-5">
    <h3>Wishlist</h3>
</div>
<div class="list-group " style="min-height: 50%;">
    {%if products%}
    {%for product in products%}

    <div class="card ms-5 me-5 mb-2 col-11" style="height: 300px;"
        onclick="window.location='/user/product/{{product.id}}'">
        <div class="row g-0 col-12" style="height: 300px;">
            <div class="col-2" style="max-height: 100%;">
                <img src="/media/{{product.image}}" class="img-fluid rounded-start " style="max-height: 100%;"
                    alt="...">
            </div>
            <div class="col-10 ">
                <div class="card-body col-12">

                    <div class=" d-flex">
                        <h5 class="card-title">{{product.title}}</h5>
                        <a href="/user/wishlist/{{product.id}}/remove" class="btn d-block ms-auto"
                            style="width: 30px;"><svg xmlns="http://www.w3.org/2000/svg" height="20" width="20"
                                viewBox="0 0 384 512">
                                <path
                                    d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
                            </svg></a>
                    </div>
                    {%if product.offer != 0%}
                    {%load user_templates_filter%}
                    <span class="card-text"><b>price:</b>₹{{product.get_offered_price}}</span>

                    <span class="card-text"><s>₹{{product.price}}</s></span>
                    <span class="text-success">{{product.offer|add:product.category.offer}}% offer</span>
                    {%else%}
                    <span class="h5">₹{{product.price}}</span>
                    {%endif%}
                    {%load user_templates_filter%}
                    <p>
                        {{product.description}}
                    </p>

                    <div class="row">
                        <dt class="col-3">Gender</dt>
                        <dd class="col-9">{{product.gender}}</dd>

                        <dt class="col-3">Category</dt>
                        <dd class="col-9">{{product.category.name}}</dd>


                        <dt class="col-3">Brand</dt>
                        <dd class="col-9">{{product.brand}}</dd>

                    </div>
                    <form method="post" action="/user/product/{{product.id}}/add_to_cart">
                        <div class="row mb-4">
                            <div class="col-2 ">
                                <label class="mb-2">Options</label>

                                <select name="option" class="form-select border border-secondary"
                                    style="height: 35px;" required>
                                    {%for option in product.options.all%}
                                    <option>{{option.name}}</option>
                                    {%endfor%}
                                </select>
                            </div>
                            <!-- col.// -->
                            <div class=" col-2 mb-3">
                                <label class="mb-2 d-block">Quantity</label>
                                <div class="input-group mb-3" >
                                    <button class="btn btn-white border border-secondary px-3" type="button"
                                        id="button-addon1" data-quantity="minus" data-field="quantity"
                                        data-mdb-ripple-color="dark">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <input type="number" name="quantity"
                                        class="input-group-field form-control text-center border border-secondary"
                                        value="1" min="0" aria-label="Example text with button addon"
                                        aria-describedby="button-addon1" />
                                    <button class="btn btn-white border border-secondary px-3" type="button"
                                        id="button-addon2" data-quantity="plus" data-field="quantity"
                                        data-mdb-ripple-color="dark">
                                        <i class="fas fa-plus"></i>
                                    </button>

                                </div>
                            </div>{%csrf_token%}
                            <div class="col-3"  >
                                
                            <button type="submit" class="btn btn-primary shadow-0" style="margin-top: 30px;">
                                <i class="me-1 fa fa-shopping-basket"></i>Add to cart
                            </button></div>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
    {%endfor%}
    {%else%}
    <h3 class="text-muted text-center ">empty</h3>
    {%endif%}
</div>

<div class="container" style="height: 100px;">
    <footer class="py-3 my-4">
        <ul class="nav justify-content-center border-bottom pb-3 mb-3">
            <li class="nav-item"><a href="/" class="nav-link px-2 text-muted">Home</a></li>
            <li class="nav-item"><a href="/user/products" class="nav-link px-2 text-muted">All Products</a></li>

            <li class="nav-item"><a href="mailto://ihsanofficial.webservice@gmail.com"
                    class="nav-link px-2 text-muted">FAQs</a></li>

        </ul>
        <p class="text-center text-muted">&copy; 2024 Ihsan, Inc</p>
    </footer>
</div>

{%endblock%}
{%block 'script'%}
<script src="https://unpkg.com/@trevoreyre/autocomplete-js"></script>
<script src="{%static 'js/search.js'%}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))

    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {

        return new bootstrap.Tooltip(tooltipTriggerEl, { placement: 'bottom', trigger: 'manual' }).show()
    })
</script>
<script>
    jQuery(document).ready(function () {
        // This button will increment the value
        $('[data-quantity="plus"]').click(function (e) {
            e.stopPropagation()
            e.preventDefault();
            // Get the field name
            fieldName = $(this).attr('data-field');
            // Get its current value
            var currentVal = parseInt($('input[name=' + fieldName + ']').val());
            // If is not undefined
            if (!isNaN(currentVal)) {
                // Increment
                $('input[name=' + fieldName + ']').val(currentVal + 1);
            } else {
                // Otherwise put a 0 there
                $('input[name=' + fieldName + ']').val(0);
            }
        });
        // This button will decrement the value till 0
        $('[data-quantity="minus"]').click(function (e) {
            e.stopPropagation()
            e.preventDefault();
            fieldName = $(this).attr('data-field');
            // Get its current value
            var currentVal = parseInt($('input[name=' + fieldName + ']').val());
            // If it isn't undefined or its greater than 0
            if (!isNaN(currentVal) && currentVal > 1) {
                // Decrement one
                $('input[name=' + fieldName + ']').val(currentVal - 1);
            } else {
                // Otherwise put a 0 there
                $('input[name=' + fieldName + ']').val(1);
            }
        });
    });
    function removeWishList(id) {
        preventDefault()
        $.ajax({
            url: "/user/wishlist/remove",
            data: { 'csrfmiddlewaretoken': '{{csrf_token}}', 'id': id },
            success: function (data) {

                document.open();
                document.write(data);
                document.close();
                window.location.replace("/user/wishlists");
                // show response from the php script.
            }
        });
    }
</script>
{%endblock%}
{%block 'extra'%}
{%include 'user/side-draw.html'%}
{%endblock%}